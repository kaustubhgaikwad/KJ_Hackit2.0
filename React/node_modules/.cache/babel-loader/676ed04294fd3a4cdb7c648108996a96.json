{"ast":null,"code":"import _toConsumableArray from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\Hackathon\\\\KJ\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\Hackathon\\\\KJ\\\\src\\\\components\\\\App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport Web3 from 'web3';\nimport Deals from '../abis/Deals.json';\nimport logo from \"../logo.png\";\nimport \"./App.css\";\nimport \"../assets/css/fontawesome-all.min.css\";\nimport \"../assets/css/main.css\";\nimport Head from \"../components/Head\";\nimport Banner from \"../components/Banner\";\nimport HeaderComponent from \"../components/HeaderComponent\";\nimport Articles from \"../components/Articles\";\nimport ArticlesParent from \"../components/ArticlesParent\";\nimport Sidebar from \"../components/Sidebar\";\nimport Complete from \"../components/complete\";\nimport TrackComponent from \"../components/TrackComponent\";\nimport \"../assets/css/login.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { BrowserRouter as Router, Switch, Link, Route, Redirect } from \"react-router-dom\";\nimport Addcontract from \"../components/Addcontract\";\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      loggedIn: false,\n      username: \"\",\n      password: \"\",\n      transactions: []\n    };\n\n    _this.handleLogin = function () {\n      if (_this.state.password === \"ameya\") {\n        _this.setState({\n          loggedIn: true\n        });\n      }\n\n      console.log(_this.state.loggedIn);\n    };\n\n    _this.handleOnChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.handleAuthentication = function () {\n      _this.history.push(\"/Home\");\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                _context.next = 4;\n                return this.loadBlockchainData();\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                window.web3 = new Web3(window.ethereum);\n                _context2.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                _context2.next = 7;\n                break;\n\n              case 6:\n                if (window.web3) {\n                  window.web3 = new Web3(window.web3.currentProvider);\n                } else {\n                  window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                }\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var web3, accounts, networkId, networkData, deals, transaction_count, i, transaction, bal;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                web3 = window.web3; // Load account\n\n                _context3.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context3.sent;\n                _context3.next = 6;\n                return web3.eth.net.getId();\n\n              case 6:\n                networkId = _context3.sent;\n                networkData = Deals.networks[networkId];\n\n                if (!networkData) {\n                  _context3.next = 30;\n                  break;\n                }\n\n                deals = web3.eth.Contract(Deals.abi, networkData.address);\n                this.setState({\n                  deals: deals\n                }); //await deals.methods.distibute_balance(\"consumer_name1\",\"consumer_name2\",\"consumer_name3\");\n                //getting all transactions in transaction array\n\n                _context3.next = 13;\n                return deals.methods.transaction_count().call();\n\n              case 13:\n                transaction_count = _context3.sent;\n                i = 1;\n\n              case 15:\n                if (!(i <= transaction_count)) {\n                  _context3.next = 23;\n                  break;\n                }\n\n                _context3.next = 18;\n                return deals.methods.transactions(i).call();\n\n              case 18:\n                transaction = _context3.sent;\n                this.setState({\n                  transactions: [].concat(_toConsumableArray(this.state.transactions), [transaction])\n                });\n\n              case 20:\n                i++;\n                _context3.next = 15;\n                break;\n\n              case 23:\n                //console.log(this.state.transactions[0].farmer_name);\n                //const name = await deals.methods.name().call()\n                deals.methods.add_transaction(\"naya_farmer_name\", \"consumer_name3\", \"product\", 1, 2).send({\n                  from: accounts[0]\n                });\n                _context3.next = 26;\n                return deals.methods.user_balance('farmer_name').call();\n\n              case 26:\n                bal = _context3.sent;\n                console.log(\"bal of consumer 1=\" + bal); //const user_count=await deals.methods.user_count().call;\n                //this.setState({ postCount })\n                // Load Posts\n                // for (var i = 1; i <= postCount; i++) {\n                //   const post = await socialNetwork.methods.posts(i).call()\n                //   this.setState({\n                //     posts: [...this.state.posts, post]\n                //   })\n                // }\n                // // Sort posts. Show highest tipped posts first\n                // this.setState({\n                //   posts: this.state.posts.sort((a,b) => b.tipAmount - a.tipAmount )\n                // })\n                // this.setState({ loading: false})\n\n                _context3.next = 31;\n                break;\n\n              case 30:\n                window.alert('Deals contract not deployed to detected network.');\n\n              case 31:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(Router, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(Route, {\n        path: \"/\",\n        exact: true,\n        strict: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"login-triangle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }), React.createElement(\"h2\", {\n        class: \"login-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"Log in\"), React.createElement(\"form\", {\n        class: \"login-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        name: \"username\",\n        placeholder: \"Username\",\n        value: this.state.userName,\n        onChange: this.handleOnChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"password\",\n        placeholder: \"Password\",\n        name: \"password\",\n        onChange: this.handleOnChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/Home\",\n        onClick: this.handleLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"Log in\"), \"/>\")))), React.createElement(Route, {\n        path: \"/Home\" //={Complete}\n        ,\n        exact: true,\n        render: function render() {\n          return _this2.state.loggedIn === true ? React.createElement(Complete, {\n            login_user: _this2.state.username,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 187\n            },\n            __self: this\n          }) : React.createElement(Redirect, {\n            to: \"/\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 187\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/contract\",\n        component: function component() {\n          return React.createElement(Addcontract, {\n            login_user: _this2.state.username,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 190\n            },\n            __self: this\n          });\n        },\n        exact: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/track\",\n        exact: true,\n        render: function render(props) {\n          return React.createElement(TrackComponent, Object.assign({}, props, {\n            transaction: _this2.state.transactions,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 191\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["E:\\Hackathon\\KJ\\src\\components\\App.js"],"names":["React","Component","Web3","Deals","logo","Head","Banner","HeaderComponent","Articles","ArticlesParent","Sidebar","Complete","TrackComponent","BrowserRouter","Router","Switch","Link","Route","Redirect","Addcontract","App","state","loggedIn","username","password","transactions","handleLogin","setState","console","log","handleOnChange","event","target","name","value","handleAuthentication","history","push","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","net","getId","networkId","networkData","networks","deals","Contract","abi","address","methods","transaction_count","call","i","transaction","add_transaction","send","from","user_balance","bal","userName","props"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './App.css';\r\nimport Web3 from 'web3';\r\nimport Deals from '../abis/Deals.json'\r\nimport logo from \"../logo.png\";\r\nimport \"./App.css\";\r\nimport \"../assets/css/fontawesome-all.min.css\";\r\nimport \"../assets/css/main.css\";\r\nimport Head from \"../components/Head\";\r\nimport Banner from \"../components/Banner\";\r\nimport HeaderComponent from \"../components/HeaderComponent\";\r\nimport Articles from \"../components/Articles\";\r\nimport ArticlesParent from \"../components/ArticlesParent\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Complete from \"../components/complete\";\r\nimport TrackComponent from \"../components/TrackComponent\"\r\nimport \"../assets/css/login.css\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\"\r\n\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Link,\r\n  Route,\r\n  Redirect\r\n} from \"react-router-dom\";\r\nimport Addcontract from \"../components/Addcontract\";\r\n\r\n\r\nclass App extends Component {\r\n\r\n  state = {\r\n    loggedIn: false,\r\n    username: \"\",\r\n    password: \"\",\r\n    transactions:[]\r\n  };\r\n\r\n  handleLogin = () => {\r\n    if (this.state.password === \"ameya\") {\r\n      this.setState({ loggedIn: true });\r\n    }\r\n    console.log(this.state.loggedIn);\r\n  };\r\n\r\n  handleOnChange = event => {\r\n    this.setState({\r\n      [event.target.name]: event.target.value\r\n    });\r\n  };\r\n\r\n  handleAuthentication = () => {\r\n    this.history.push(\"/Home\");\r\n  };\r\n  \r\n  async componentWillMount() {\r\n    await this.loadWeb3()\r\n    await this.loadBlockchainData()\r\n  }\r\n\r\n  async loadWeb3() {\r\n    if (window.ethereum) {\r\n      window.web3 = new Web3(window.ethereum)\r\n      await window.ethereum.enable()\r\n    }\r\n    else if (window.web3) {\r\n      window.web3 = new Web3(window.web3.currentProvider)\r\n    }\r\n    else {\r\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\r\n    }\r\n  }\r\n\r\n  async loadBlockchainData(){\r\n    const web3 = window.web3\r\n    // Load account\r\n    const accounts = await web3.eth.getAccounts()\r\n    //this.setState({ account: accounts[0] })\r\n    // Network ID\r\n    const networkId = await web3.eth.net.getId()\r\n    const networkData = Deals.networks[networkId]\r\n    if(networkData) {\r\n      const deals = web3.eth.Contract(Deals.abi, networkData.address)\r\n      this.setState({ deals })\r\n      //await deals.methods.distibute_balance(\"consumer_name1\",\"consumer_name2\",\"consumer_name3\");\r\n\r\n      //getting all transactions in transaction array\r\n      const transaction_count= await deals.methods.transaction_count().call();\r\n      for (var i = 1; i <= transaction_count; i++) {\r\n        const transaction = await deals.methods.transactions(i).call()\r\n        this.setState({\r\n          transactions: [...this.state.transactions, transaction]\r\n        })\r\n      }\r\n      //console.log(this.state.transactions[0].farmer_name);\r\n      //const name = await deals.methods.name().call()\r\n      deals.methods.add_transaction(\"naya_farmer_name\",\r\n                                    \"consumer_name3\",\r\n                                    \"product\",\r\n                                    1,\r\n                                    2,\r\n                                    ).send({ from: accounts[0] })\r\n              \r\n      const bal=await deals.methods.user_balance('farmer_name').call()\r\n      console.log(\"bal of consumer 1=\"+bal);\r\n      //const user_count=await deals.methods.user_count().call;\r\n      \r\n      \r\n      //this.setState({ postCount })\r\n      // Load Posts\r\n      // for (var i = 1; i <= postCount; i++) {\r\n      //   const post = await socialNetwork.methods.posts(i).call()\r\n      //   this.setState({\r\n      //     posts: [...this.state.posts, post]\r\n      //   })\r\n      // }\r\n      // // Sort posts. Show highest tipped posts first\r\n      // this.setState({\r\n      //   posts: this.state.posts.sort((a,b) => b.tipAmount - a.tipAmount )\r\n      // })\r\n      // this.setState({ loading: false})\r\n    } else {\r\n      window.alert('Deals contract not deployed to detected network.')\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n      <Router>\r\n        {/* <div>\r\n          <input type=\"text\" id=\"tp\" name=\"tp\" />\r\n          <input\r\n            type=\"text\"\r\n            id=\"username\"\r\n            name=\"username\"\r\n            value={this.state.userName}\r\n            onChange={this.handleLogin}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            id=\"password\"\r\n            name=\"password\"\r\n            value={this.state.password}\r\n            onChange={this.handleOnChange}\r\n          />\r\n          <input type=\"button\" onClick={this.handleLogin} value=\"login\" />\r\n        </div> */}\r\n        <Route path=\"/\" exact strict>\r\n          <div class=\"login\">\r\n            <div class=\"login-triangle\"></div>\r\n\r\n            <h2 class=\"login-header\">Log in</h2>\r\n\r\n            <form class=\"login-container\">\r\n              <p>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"username\"\r\n                  placeholder=\"Username\"\r\n                  value={this.state.userName}\r\n                  onChange={this.handleOnChange}\r\n                />\r\n              </p>\r\n              <p>\r\n                <input\r\n                  type=\"password\"\r\n                  placeholder=\"Password\"\r\n                  name=\"password\"\r\n                  onChange={this.handleOnChange}\r\n                />\r\n              </p>\r\n              <p>\r\n                <Link to=\"/Home\" onClick={this.handleLogin}>\r\n                  Log in\r\n                </Link>\r\n                />\r\n              </p>\r\n            </form>\r\n          </div>\r\n        </Route>\r\n        <Route\r\n          path=\"/Home\"\r\n          //={Complete}\r\n          exact\r\n          render={() =>\r\n            this.state.loggedIn === true ? <Complete login_user={this.state.username} /> : <Redirect to=\"/\" />\r\n          }\r\n        />\r\n        <Route path=\"/contract\" component={() => <Addcontract login_user={this.state.username}/>} exact />\r\n        <Route path=\"/track\" exact render={(props) => <TrackComponent {...props} transaction={this.state.transactions} />}  />\r\n      </Router>\r\n    </div>\r\n  );\r\n  }\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}